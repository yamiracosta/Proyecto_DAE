/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JDialog.java to edit this template
 */
package Presentacion;

import Negocio.Asistencia;
import Negocio.Empleado;
import java.sql.ResultSet;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author jefer
 */
public class jdControlAsistencia extends javax.swing.JDialog {

    Empleado objE = new Empleado();
    Asistencia objA = new Asistencia();

    public jdControlAsistencia(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        setLocationRelativeTo(this);

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        btnVolver1 = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        jPanel2 = new javax.swing.JPanel();
        txtNumDocEmpleado = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblEmpleados = new javax.swing.JTable();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblAsistencia = new javax.swing.JTable();
        jLabel7 = new javax.swing.JLabel();
        cboMeses = new javax.swing.JComboBox<>();
        jLabel4 = new javax.swing.JLabel();
        lblNumAsistencias = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        btnAsistencia = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        btnTardanza = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        btnInasistencia = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        btnTardanzaJustificada = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        btnInasistenciaJustificada = new btn_efecto01_jwc.btn_efecto_V1_JWC();
        jPanel5 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        lblNumFaltas = new javax.swing.JLabel();
        lblNumTardanzas = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        lblNumTardanzasJustificadas = new javax.swing.JLabel();
        lblNumFaltasJustificadas = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setUndecorated(true);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowActivated(java.awt.event.WindowEvent evt) {
                formWindowActivated(evt);
            }
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jPanel1.setEnabled(false);

        jLabel1.setFont(new java.awt.Font("Nirmala UI", 1, 18)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 0, 0));
        jLabel1.setText("CONTROL DE ASISTENCIA");

        btnVolver1.setBackground(new java.awt.Color(255, 255, 255));
        btnVolver1.setForeground(new java.awt.Color(255, 255, 255));
        btnVolver1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/boton-x.png"))); // NOI18N
        btnVolver1.setText("");
        btnVolver1.setBackground_Hover_1(new java.awt.Color(255, 51, 51));
        btnVolver1.setBackground_Hover_2(new java.awt.Color(204, 0, 0));
        btnVolver1.setBackground_No_Hover_1(new java.awt.Color(255, 51, 51));
        btnVolver1.setBackground_No_Hover_2(new java.awt.Color(204, 0, 0));
        btnVolver1.setEsquina_inferior_derecho(20);
        btnVolver1.setEsquina_inferior_izquierdo(20);
        btnVolver1.setEsquina_superior_derecho(20);
        btnVolver1.setEsquina_superior_izquierdo(20);
        btnVolver1.setFont(new java.awt.Font("Nirmala UI", 1, 14)); // NOI18N
        btnVolver1.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnVolver1.setIconTextGap(8);
        btnVolver1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVolver1ActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(69, 161, 137));

        txtNumDocEmpleado.setFont(new java.awt.Font("Nirmala UI", 0, 14)); // NOI18N
        txtNumDocEmpleado.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        txtNumDocEmpleado.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtNumDocEmpleadoKeyReleased(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtNumDocEmpleadoKeyTyped(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Nirmala UI", 1, 14)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(255, 255, 255));
        jLabel6.setText("Ingrese número de documento:");

        tblEmpleados.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        tblEmpleados.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        tblEmpleados.setGridColor(new java.awt.Color(0, 0, 0));
        tblEmpleados.setSelectionBackground(new java.awt.Color(153, 153, 153));
        tblEmpleados.setSelectionForeground(new java.awt.Color(255, 255, 255));
        tblEmpleados.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblEmpleadosMouseClicked(evt);
            }
        });
        tblEmpleados.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tblEmpleadosPropertyChange(evt);
            }
        });
        tblEmpleados.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                tblEmpleadosKeyReleased(evt);
            }
        });
        jScrollPane1.setViewportView(tblEmpleados);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtNumDocEmpleado)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel6)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane1))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtNumDocEmpleado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3.setBackground(new java.awt.Color(51, 51, 51));

        tblAsistencia.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        tblAsistencia.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        tblAsistencia.setGridColor(new java.awt.Color(0, 0, 0));
        tblAsistencia.setSelectionBackground(new java.awt.Color(153, 153, 153));
        tblAsistencia.setSelectionForeground(new java.awt.Color(255, 255, 255));
        tblAsistencia.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblAsistenciaMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tblAsistencia);

        jLabel7.setFont(new java.awt.Font("Nirmala UI", 1, 14)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("Ficha de Asistencia");

        cboMeses.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cboMesesItemStateChanged(evt);
            }
        });

        jLabel4.setFont(new java.awt.Font("Nirmala UI", 1, 14)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("Total de asistencias:");

        lblNumAsistencias.setFont(new java.awt.Font("Nirmala UI", 0, 14)); // NOI18N
        lblNumAsistencias.setForeground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 633, Short.MAX_VALUE)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel7)
                        .addGap(18, 18, 18)
                        .addComponent(cboMeses, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lblNumAsistencias, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cboMeses, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel4))
                    .addComponent(lblNumAsistencias, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 318, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel4.setBackground(new java.awt.Color(86, 201, 170));

        btnAsistencia.setBackground(new java.awt.Color(51, 102, 0));
        btnAsistencia.setForeground(new java.awt.Color(255, 255, 255));
        btnAsistencia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/btn_asistencia.png"))); // NOI18N
        btnAsistencia.setText("Registrar asistencia");
        btnAsistencia.setBackground_Hover_1(new java.awt.Color(51, 102, 0));
        btnAsistencia.setBackground_Hover_2(new java.awt.Color(51, 102, 0));
        btnAsistencia.setBackground_No_Hover_1(new java.awt.Color(51, 102, 0));
        btnAsistencia.setBackground_No_Hover_2(new java.awt.Color(51, 102, 0));
        btnAsistencia.setColor_Hover_text(new java.awt.Color(0, 0, 0));
        btnAsistencia.setColor_NoHover_text(new java.awt.Color(0, 0, 0));
        btnAsistencia.setEnabled(false);
        btnAsistencia.setEsquina_inferior_derecho(20);
        btnAsistencia.setEsquina_inferior_izquierdo(20);
        btnAsistencia.setEsquina_superior_derecho(20);
        btnAsistencia.setEsquina_superior_izquierdo(20);
        btnAsistencia.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        btnAsistencia.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnAsistencia.setIconTextGap(8);
        btnAsistencia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAsistenciaActionPerformed(evt);
            }
        });
        btnAsistencia.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                btnAsistenciaPropertyChange(evt);
            }
        });

        btnTardanza.setBackground(new java.awt.Color(255, 204, 0));
        btnTardanza.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/btn_tardanza.png"))); // NOI18N
        btnTardanza.setText("Registrar tardanza");
        btnTardanza.setBackground_Hover_1(new java.awt.Color(255, 204, 0));
        btnTardanza.setBackground_Hover_2(new java.awt.Color(255, 204, 0));
        btnTardanza.setBackground_No_Hover_1(new java.awt.Color(255, 204, 0));
        btnTardanza.setBackground_No_Hover_2(new java.awt.Color(255, 204, 0));
        btnTardanza.setColor_Hover_text(new java.awt.Color(0, 0, 0));
        btnTardanza.setColor_NoHover_text(new java.awt.Color(0, 0, 0));
        btnTardanza.setEnabled(false);
        btnTardanza.setEsquina_inferior_derecho(20);
        btnTardanza.setEsquina_inferior_izquierdo(20);
        btnTardanza.setEsquina_superior_derecho(20);
        btnTardanza.setEsquina_superior_izquierdo(20);
        btnTardanza.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        btnTardanza.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnTardanza.setIconTextGap(8);
        btnTardanza.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTardanzaActionPerformed(evt);
            }
        });
        btnTardanza.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                btnTardanzaPropertyChange(evt);
            }
        });

        btnInasistencia.setBackground(new java.awt.Color(255, 204, 0));
        btnInasistencia.setForeground(new java.awt.Color(255, 255, 255));
        btnInasistencia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/btn_inasistencia.png"))); // NOI18N
        btnInasistencia.setText("Registrar inasistencia");
        btnInasistencia.setBackground_Hover_1(new java.awt.Color(255, 51, 51));
        btnInasistencia.setBackground_Hover_2(new java.awt.Color(255, 51, 51));
        btnInasistencia.setBackground_No_Hover_1(new java.awt.Color(255, 51, 51));
        btnInasistencia.setBackground_No_Hover_2(new java.awt.Color(255, 51, 51));
        btnInasistencia.setColor_Hover_text(new java.awt.Color(0, 0, 0));
        btnInasistencia.setColor_NoHover_text(new java.awt.Color(0, 0, 0));
        btnInasistencia.setEnabled(false);
        btnInasistencia.setEsquina_inferior_derecho(20);
        btnInasistencia.setEsquina_inferior_izquierdo(20);
        btnInasistencia.setEsquina_superior_derecho(20);
        btnInasistencia.setEsquina_superior_izquierdo(20);
        btnInasistencia.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        btnInasistencia.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnInasistencia.setIconTextGap(8);
        btnInasistencia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnInasistenciaActionPerformed(evt);
            }
        });
        btnInasistencia.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                btnInasistenciaPropertyChange(evt);
            }
        });

        btnTardanzaJustificada.setBackground(new java.awt.Color(255, 204, 0));
        btnTardanzaJustificada.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/btn_justificar_falta.png"))); // NOI18N
        btnTardanzaJustificada.setText("Justificar tardanza");
        btnTardanzaJustificada.setBackground_Hover_1(new java.awt.Color(255, 204, 0));
        btnTardanzaJustificada.setBackground_Hover_2(new java.awt.Color(255, 204, 0));
        btnTardanzaJustificada.setBackground_No_Hover_1(new java.awt.Color(255, 204, 0));
        btnTardanzaJustificada.setBackground_No_Hover_2(new java.awt.Color(255, 204, 0));
        btnTardanzaJustificada.setColor_Hover_text(new java.awt.Color(0, 0, 0));
        btnTardanzaJustificada.setColor_NoHover_text(new java.awt.Color(0, 0, 0));
        btnTardanzaJustificada.setEnabled(false);
        btnTardanzaJustificada.setEsquina_inferior_derecho(20);
        btnTardanzaJustificada.setEsquina_inferior_izquierdo(20);
        btnTardanzaJustificada.setEsquina_superior_derecho(20);
        btnTardanzaJustificada.setEsquina_superior_izquierdo(20);
        btnTardanzaJustificada.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        btnTardanzaJustificada.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnTardanzaJustificada.setIconTextGap(8);
        btnTardanzaJustificada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTardanzaJustificadaActionPerformed(evt);
            }
        });
        btnTardanzaJustificada.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                btnTardanzaJustificadaPropertyChange(evt);
            }
        });

        btnInasistenciaJustificada.setBackground(new java.awt.Color(255, 204, 0));
        btnInasistenciaJustificada.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/btn_justificar_falta.png"))); // NOI18N
        btnInasistenciaJustificada.setText("Justificar falta");
        btnInasistenciaJustificada.setBackground_Hover_1(new java.awt.Color(255, 204, 0));
        btnInasistenciaJustificada.setBackground_Hover_2(new java.awt.Color(255, 204, 0));
        btnInasistenciaJustificada.setBackground_No_Hover_1(new java.awt.Color(255, 204, 0));
        btnInasistenciaJustificada.setBackground_No_Hover_2(new java.awt.Color(255, 204, 0));
        btnInasistenciaJustificada.setColor_Hover_text(new java.awt.Color(0, 0, 0));
        btnInasistenciaJustificada.setColor_NoHover_text(new java.awt.Color(0, 0, 0));
        btnInasistenciaJustificada.setEnabled(false);
        btnInasistenciaJustificada.setEsquina_inferior_derecho(20);
        btnInasistenciaJustificada.setEsquina_inferior_izquierdo(20);
        btnInasistenciaJustificada.setEsquina_superior_derecho(20);
        btnInasistenciaJustificada.setEsquina_superior_izquierdo(20);
        btnInasistenciaJustificada.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        btnInasistenciaJustificada.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btnInasistenciaJustificada.setIconTextGap(8);
        btnInasistenciaJustificada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnInasistenciaJustificadaActionPerformed(evt);
            }
        });
        btnInasistenciaJustificada.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                btnInasistenciaJustificadaPropertyChange(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(47, 47, 47)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnTardanza, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btnAsistencia, javax.swing.GroupLayout.DEFAULT_SIZE, 167, Short.MAX_VALUE)
                    .addComponent(btnInasistencia, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btnTardanzaJustificada, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btnInasistenciaJustificada, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addGap(47, 47, 47))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap(20, Short.MAX_VALUE)
                .addComponent(btnAsistencia, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnTardanza, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnInasistencia, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnTardanzaJustificada, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnInasistenciaJustificada, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(19, 19, 19))
        );

        jPanel5.setBackground(new java.awt.Color(86, 201, 170));

        jLabel2.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(0, 0, 0));
        jLabel2.setText("N° faltas:");

        jLabel3.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 0, 0));
        jLabel3.setText("N° tardanzas:");

        lblNumFaltas.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        lblNumFaltas.setForeground(new java.awt.Color(0, 0, 0));

        lblNumTardanzas.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        lblNumTardanzas.setForeground(new java.awt.Color(0, 0, 0));

        jLabel8.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(0, 0, 0));
        jLabel8.setText("N° faltas justificadas:");

        jLabel9.setFont(new java.awt.Font("Nirmala UI", 1, 12)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(0, 0, 0));
        jLabel9.setText("N° tardanzas justificadas:");

        lblNumTardanzasJustificadas.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        lblNumTardanzasJustificadas.setForeground(new java.awt.Color(0, 0, 0));

        lblNumFaltasJustificadas.setFont(new java.awt.Font("Nirmala UI", 0, 12)); // NOI18N
        lblNumFaltasJustificadas.setForeground(new java.awt.Color(0, 0, 0));

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lblNumFaltas, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(lblNumTardanzas, javax.swing.GroupLayout.PREFERRED_SIZE, 14, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel9)
                            .addComponent(jLabel8))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(lblNumFaltasJustificadas, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                            .addComponent(lblNumTardanzasJustificadas, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel2)
                        .addComponent(jLabel3)
                        .addComponent(lblNumTardanzas, javax.swing.GroupLayout.PREFERRED_SIZE, 16, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lblNumFaltas, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lblNumFaltasJustificadas, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lblNumTardanzasJustificadas, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnVolver1, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnVolver1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnVolver1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVolver1ActionPerformed
        this.dispose();
    }//GEN-LAST:event_btnVolver1ActionPerformed

    private void tblEmpleadosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblEmpleadosMouseClicked
        try {
            String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
            String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
            int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);
            if (tblEmpleados.getSelectedRowCount() > 0) {
                mostrarMesesDisponibles(idempl);
                if (cboMeses.getSelectedItem() != null) {
                    cboMeses.setEnabled(true);
                    filtrarAsistencia();
                } else {
                    cboMeses.removeAllItems();
                    mostrarTablaVacia();
                    cboMeses.setEnabled(false);
                    deshabilitarBotones();
                    lblNumAsistencias.setText("");
                    lblNumFaltas.setText("");
                    lblNumFaltasJustificadas.setText("");
                    lblNumTardanzas.setText("");
                    lblNumTardanzasJustificadas.setText("");
                    JOptionPane.showMessageDialog(rootPane, "No hay ficha de asistencia para este empleado");
                }
            }
        } catch (Exception ex) {
            Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_tblEmpleadosMouseClicked

    private void txtNumDocEmpleadoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNumDocEmpleadoKeyReleased
        try {
            listarEmpleadosConContratoVigente();
        } catch (Exception ex) {
            Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_txtNumDocEmpleadoKeyReleased

    private void txtNumDocEmpleadoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtNumDocEmpleadoKeyTyped
        if (txtNumDocEmpleado.getText().length() >= 20) {
            evt.consume();
        }
    }//GEN-LAST:event_txtNumDocEmpleadoKeyTyped

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        try {
            listarEmpleadosConContratoVigente();
        } catch (Exception ex) {
            Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_formWindowOpened

    private void tblEmpleadosPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tblEmpleadosPropertyChange
        try {
            if (tblEmpleados.getSelectedRowCount() <= 0) {
                mostrarTablaVacia();
                deshabilitarBotones();
                cboMeses.setEnabled(false);
            }
        } catch (Exception ex) {
            Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_tblEmpleadosPropertyChange

    private void btnAsistenciaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAsistenciaActionPerformed
        int opcion = JOptionPane.showConfirmDialog(rootPane, "¿Registrar asistencia?", "Confirmar cambios", JOptionPane.YES_NO_OPTION);
        if (opcion == JOptionPane.YES_OPTION) {
            try {
                //fecha
                String fechatxt = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 1).toString();

                //idempleado
                String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
                String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
                int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);
                //Cambiamos el estado
                objA.cambiarEstadoAsistencia("A", parseDate(fechatxt), idempl);
                filtrarAsistencia();
                JOptionPane.showMessageDialog(rootPane, "Asistencia registrada");
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_btnAsistenciaActionPerformed

    private void btnAsistenciaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_btnAsistenciaPropertyChange

    }//GEN-LAST:event_btnAsistenciaPropertyChange

    private void btnInasistenciaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnInasistenciaActionPerformed
        int opcion = JOptionPane.showConfirmDialog(rootPane, "¿Registrar inasistencia?", "Confirmar cambios", JOptionPane.YES_NO_OPTION);
        if (opcion == JOptionPane.YES_OPTION) {
            try {
                //fecha
                String fechatxt = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 1).toString();

                //idempleado
                String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
                String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
                int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);

                //Cambiamos el estado
                objA.cambiarEstadoAsistencia("F", parseDate(fechatxt), idempl);
                filtrarAsistencia();
                JOptionPane.showMessageDialog(rootPane, "Inasistencia registrada");
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_btnInasistenciaActionPerformed

    private void btnInasistenciaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_btnInasistenciaPropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_btnInasistenciaPropertyChange

    private void btnTardanzaJustificadaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTardanzaJustificadaActionPerformed
        int opcion = JOptionPane.showConfirmDialog(rootPane, "¿Justificar tardanza?", "Confirmar cambios", JOptionPane.YES_NO_OPTION);
        if (opcion == JOptionPane.YES_OPTION) {
            try {
                //fecha
                String fechatxt = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 1).toString();

                //idempleado
                String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
                String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
                int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);

                //Cambiamos el estado
                objA.cambiarEstadoAsistencia("TJ", parseDate(fechatxt), idempl);
                filtrarAsistencia();
                JOptionPane.showMessageDialog(rootPane, "Justificación de tardanza registrada");
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_btnTardanzaJustificadaActionPerformed

    private void btnTardanzaJustificadaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_btnTardanzaJustificadaPropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_btnTardanzaJustificadaPropertyChange

    private void btnInasistenciaJustificadaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnInasistenciaJustificadaActionPerformed
        int opcion = JOptionPane.showConfirmDialog(rootPane, "¿Justificar inasistencia?", "Confirmar cambios", JOptionPane.YES_NO_OPTION);
        if (opcion == JOptionPane.YES_OPTION) {
            try {
                //fecha
                String fechatxt = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 1).toString();

                //idempleado
                String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
                String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
                int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);

                //Cambiamos el estado
                objA.cambiarEstadoAsistencia("FJ", parseDate(fechatxt), idempl);
                filtrarAsistencia();
                JOptionPane.showMessageDialog(rootPane, "Justificación de inasistencia registrada");
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_btnInasistenciaJustificadaActionPerformed

    private void btnInasistenciaJustificadaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_btnInasistenciaJustificadaPropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_btnInasistenciaJustificadaPropertyChange

    private void tblAsistenciaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblAsistenciaMouseClicked
        String estado = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 4).toString();
        if (estado.endsWith("Asistió")) {
            btnAsistencia.setEnabled(false);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(true);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("Tardanza")) {
            btnAsistencia.setEnabled(false);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(true);
            btnTardanzaJustificada.setEnabled(true);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("Faltó")) {
            btnAsistencia.setEnabled(true);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(false);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(true);
        } else if (estado.endsWith("Tardanza justificada")) {
            btnAsistencia.setEnabled(false);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(false);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("Falta justificada")) {
            btnAsistencia.setEnabled(false);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(false);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("Con permiso")) {
            btnAsistencia.setEnabled(true);
            btnTardanza.setEnabled(true);
            btnInasistencia.setEnabled(false);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("De vacaciones")) {
            btnAsistencia.setEnabled(false);
            btnTardanza.setEnabled(false);
            btnInasistencia.setEnabled(false);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        } else if (estado.endsWith("Pendiente")) {
            btnAsistencia.setEnabled(true);
            btnTardanza.setEnabled(true);
            btnInasistencia.setEnabled(true);
            btnTardanzaJustificada.setEnabled(false);
            btnInasistenciaJustificada.setEnabled(false);
        }
    }//GEN-LAST:event_tblAsistenciaMouseClicked

    private void cboMesesItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cboMesesItemStateChanged
        if (cboMeses.getSelectedItem() != null) {
            try {
                filtrarAsistencia();
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_cboMesesItemStateChanged

    private void tblEmpleadosKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tblEmpleadosKeyReleased
        /*
        try {
            String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
            String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
            int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);
            if (tblEmpleados.getSelectedRowCount() > 0) {
                mostrarMesesDisponibles(idempl);
                if (cboMeses.getSelectedItem() != null) {
                    cboMeses.setEnabled(true);
                    filtrarAsistencia();
                } else {
                    cboMeses.removeAllItems();
                    mostrarTablaVacia();
                    cboMeses.setEnabled(false);
                    deshabilitarBotones();
                    JOptionPane.showMessageDialog(rootPane, "No hay ficha de asistencia para este empleado");
                }
            }
        } catch (Exception ex) {
            Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
        }
         */
    }//GEN-LAST:event_tblEmpleadosKeyReleased

    private void btnTardanzaPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_btnTardanzaPropertyChange

    }//GEN-LAST:event_btnTardanzaPropertyChange

    private void btnTardanzaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTardanzaActionPerformed
        int opcion = JOptionPane.showConfirmDialog(rootPane, "¿Registrar tardanza?", "Confirmar cambios", JOptionPane.YES_NO_OPTION);
        if (opcion == JOptionPane.YES_OPTION) {
            try {
                //fecha
                String fechatxt = tblAsistencia.getValueAt(tblAsistencia.getSelectedRow(), 1).toString();

                //idempleado
                String numdoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString();
                String tipodoc = tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString();
                int idempl = objE.obtenerIdEmpleado(numdoc, tipodoc);

                //Cambiamos el estado
                objA.cambiarEstadoAsistencia("T", parseDate(fechatxt), idempl);
                filtrarAsistencia();
                JOptionPane.showMessageDialog(rootPane, "Tardanza registrada");
            } catch (Exception ex) {
                Logger.getLogger(jdControlAsistencia.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }//GEN-LAST:event_btnTardanzaActionPerformed

    private void formWindowActivated(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowActivated
        // TODO add your handling code here:
    }//GEN-LAST:event_formWindowActivated

    private void listarEmpleadosConContratoVigente() throws Exception {

        DefaultTableModel modelo = new DefaultTableModel();

        modelo.addColumn("Número de documento");
        modelo.addColumn("Tipo de documento");
        modelo.addColumn("Apellido paterno");
        modelo.addColumn("Apellido materno");
        modelo.addColumn("Nombres");
        modelo.addColumn("Tipo de empleado");
        modelo.addColumn("Área");

        String nombre = txtNumDocEmpleado.getText();
        ResultSet rs = objE.filtrarEmpleadoConContratoVigente(nombre);

        Object datos[] = new Object[7];

        while (rs.next()) {
            datos[0] = rs.getString("numdocumento");
            datos[1] = rs.getString("nombretipodoc");
            datos[2] = rs.getString("ape_paterno");
            datos[3] = rs.getString("ape_materno");
            datos[4] = rs.getString("nombres");
            datos[5] = rs.getString("nombretipoempleado");
            datos[6] = rs.getString("nombrearea");
            modelo.addRow(datos);
        }
        tblEmpleados.setModel(modelo);

    }

    private void mostrarMesesDisponibles(int idemp) throws Exception {
        cboMeses.removeAllItems();
        ResultSet rsmeses = objA.obtenerMesesDisponibles(idemp);

        String nombremes = "";
        while (rsmeses.next()) {
            int nummes = rsmeses.getInt("mes");
            switch (nummes) {
                case 1 ->
                    nombremes = "enero";
                case 2 ->
                    nombremes = "febrero";
                case 3 ->
                    nombremes = "marzo";
                case 4 ->
                    nombremes = "abril";
                case 5 ->
                    nombremes = "mayo";
                case 6 ->
                    nombremes = "junio";
                case 7 ->
                    nombremes = "julio";
                case 8 ->
                    nombremes = "agosto";
                case 9 ->
                    nombremes = "septiembre";
                case 10 ->
                    nombremes = "octubre";
                case 11 ->
                    nombremes = "noviembre";
                case 12 ->
                    nombremes = "diciembre";
                default ->
                    throw new AssertionError();
            }
            cboMeses.addItem(nombremes);
        }
    }

    private void filtrarAsistencia() throws Exception {
        SimpleDateFormat formatoEntrada = new SimpleDateFormat("dd-MM-yyyy");
        SimpleDateFormat formatoSalida = new SimpleDateFormat("dd MMM yyyy");

        int idempl
                = objE.obtenerIdEmpleado(tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 0).toString(),
                        tblEmpleados.getValueAt(tblEmpleados.getSelectedRow(), 1).toString());

        String nombremes = cboMeses.getSelectedItem().toString();
        int mes = 0;

        switch (nombremes) {
            case "enero" ->
                mes = 1;
            case "febrero" ->
                mes = 2;
            case "marzo" ->
                mes = 3;
            case "abril" ->
                mes = 4;
            case "mayo" ->
                mes = 5;
            case "junio" ->
                mes = 6;
            case "julio" ->
                mes = 7;
            case "agosto" ->
                mes = 8;
            case "septiembre" ->
                mes = 9;
            case "octubre" ->
                mes = 10;
            case "noviembre" ->
                mes = 11;
            case "diciembre" ->
                mes = 12;
            default ->
                throw new AssertionError();
        }

        ResultSet rsficha = objA.filtrarAsistencia(idempl, mes);
        DefaultTableModel modelo = new DefaultTableModel();
        modelo.addColumn("Día");
        modelo.addColumn("Fecha");
        modelo.addColumn("Hora de entrada");
        modelo.addColumn("Hora de salida");
        modelo.addColumn("Estado");

        Object datos[] = new Object[5];

        while (rsficha.next()) {
            datos[0] = rsficha.getString("dia_semana");
            Date fecha = formatoEntrada.parse(rsficha.getString("fecha"));
            String fechaFormateada = formatoSalida.format(fecha);
            datos[1] = fechaFormateada;
            datos[2] = rsficha.getString("horaentrada");
            datos[3] = rsficha.getString("horasalida");
            datos[4] = rsficha.getString("estado");
            modelo.addRow(datos);
        }
        tblAsistencia.setModel(modelo);

        int numasist = 0;
        int numfalt = 0;
        int numfaltJ = 0;
        int numTard = 0;
        int numTardJ = 0;

        //Calcular el récord de asistencia:
        for (int i = 0; i < tblAsistencia.getRowCount(); i++) {
            if (tblAsistencia.getValueAt(i, 4).equals("Asistió")) {
                numasist++;
            } else if (tblAsistencia.getValueAt(i, 4).equals("Tardanza")) {
                numTard++;
            } else if (tblAsistencia.getValueAt(i, 4).equals("Faltó")) {
                numfalt++;
            } else if (tblAsistencia.getValueAt(i, 4).equals("Tardanza justificada")) {
                numTardJ++;
            } else if (tblAsistencia.getValueAt(i, 4).equals("Falta justificada")) {
                numfaltJ++;
            }
        }

        lblNumAsistencias.setText(String.valueOf(numasist));
        lblNumFaltas.setText(String.valueOf(numfalt));
        lblNumFaltasJustificadas.setText(String.valueOf(numfaltJ));
        lblNumTardanzas.setText(String.valueOf(numTard));
        lblNumTardanzasJustificadas.setText(String.valueOf(numTardJ));
    }

    private void mostrarTablaVacia() {
        DefaultTableModel modelo = new DefaultTableModel();
        modelo.addColumn("Día");
        modelo.addColumn("Fecha");
        modelo.addColumn("Hora de entrada");
        modelo.addColumn("Hora de salida");
        modelo.addColumn("Estado");
        tblAsistencia.setModel(modelo);
    }

    private void deshabilitarBotones() {
        btnAsistencia.setEnabled(false);
        btnTardanza.setEnabled(false);
        btnInasistencia.setEnabled(false);
        btnTardanzaJustificada.setEnabled(false);
        btnInasistenciaJustificada.setEnabled(false);
    }

    private java.sql.Date parseDate(String fechaTexto) throws ParseException {
        SimpleDateFormat formatoEntrada = new SimpleDateFormat("dd MMM yyyy");
        Date fechaUtil = formatoEntrada.parse(fechaTexto);
        java.sql.Date fechaSQL = new java.sql.Date(fechaUtil.getTime());
        return fechaSQL;
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnAsistencia;
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnInasistencia;
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnInasistenciaJustificada;
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnTardanza;
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnTardanzaJustificada;
    private btn_efecto01_jwc.btn_efecto_V1_JWC btnVolver1;
    private javax.swing.JComboBox<String> cboMeses;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JLabel lblNumAsistencias;
    private javax.swing.JLabel lblNumFaltas;
    private javax.swing.JLabel lblNumFaltasJustificadas;
    private javax.swing.JLabel lblNumTardanzas;
    private javax.swing.JLabel lblNumTardanzasJustificadas;
    private javax.swing.JTable tblAsistencia;
    private javax.swing.JTable tblEmpleados;
    private javax.swing.JTextField txtNumDocEmpleado;
    // End of variables declaration//GEN-END:variables
}
